<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8">
<title>Dodge Game med Ljud</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body {
    margin: 0;
    background: #111;
    overflow: hidden;
    font-family: Arial, sans-serif;
  }
  #score {
    position: fixed;
    top: 10px;
    left: 10px;
    color: white;
    font-size: 24px;
  }
  #gameOver {
    position: fixed;
    inset: 0;
    display: none;
    justify-content: center;
    align-items: center;
    background: rgba(0,0,0,0.9);
    color: white;
    flex-direction: column;
    text-align: center;
  }
  #player {
    width: 50px;
    height: 50px;
    background: #00ffdd;
    position: absolute;
    bottom: 20px;
    left: calc(50% - 25px);
    border-radius: 10px;
  }
  .enemy {
    width: 50px;
    height: 50px;
    background: #ff3c3c;
    position: absolute;
    top: 0;
    border-radius: 10px;
  }
</style>
</head>
<body>

<div id="score">PoÃ¤ng: 0</div>
<div id="player"></div>
<div id="gameOver">
  <h1>GAME OVER ðŸ’€</h1>
  <p id="finalScore"></p>
  <button onclick="location.reload()">Spela igen</button>
</div>

<script>
// ===== AUDIO =====
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
function playBeep(freq, duration) {
  const osc = audioCtx.createOscillator();
  const gain = audioCtx.createGain();
  osc.connect(gain);
  gain.connect(audioCtx.destination);
  osc.frequency.value = freq;
  osc.type = "square";
  gain.gain.value = 0.1;
  osc.start();
  setTimeout(() => osc.stop(), duration);
}

// ===== GAME =====
const player = document.getElementById('player');
let score = 0;
let playerX = window.innerWidth/2 - 25;
let enemies = [];
let gameSpeed = 2;
let isGameOver = false;

// styrning
document.addEventListener('keydown', (e)=>{
  const step = 30;
  if(e.key === "ArrowLeft") playerX -= step;
  if(e.key === "ArrowRight") playerX += step;
  if(playerX < 0) playerX = 0;
  if(playerX > window.innerWidth-50) playerX = window.innerWidth-50;
  player.style.left = playerX + "px";
});

// skapa fiende
function spawnEnemy() {
  const enemy = document.createElement('div');
  enemy.classList.add('enemy');
  enemy.style.left = Math.random() * (window.innerWidth-50) + "px";
  enemy.style.top = "0px";
  document.body.appendChild(enemy);
  enemies.push(enemy);
}

// rÃ¶relse fiender
function updateEnemies() {
  enemies.forEach((enemy, index)=>{
    let y = parseInt(enemy.style.top);
    y += gameSpeed;
    enemy.style.top = y + "px";

    // kollision
    const ex = parseInt(enemy.style.left);
    const ey = y;
    const px = playerX;
    const py = parseInt(player.style.bottom || 20);

    if(ey + 50 >= window.innerHeight - 70 && ex + 50 > px && ex < px + 50){
      endGame();
    }

    // ta bort fiender som gÃ¥tt ut
    if(y > window.innerHeight){
      enemy.remove();
      enemies.splice(index,1);
      score++;
      document.getElementById('score').innerText = "PoÃ¤ng: " + score;
      playBeep(600, 50);
    }
  });
}

// game over
function endGame() {
  if(isGameOver) return;
  isGameOver = true;
  playBeep(150, 600);
  document.getElementById('finalScore').innerText = "Din poÃ¤ng: " + score;
  document.getElementById('gameOver').style.display = "flex";
}

// game loop
function gameLoop() {
  if(!isGameOver){
    updateEnemies();
    requestAnimationFrame(gameLoop);
  }
}
gameLoop();

// spawn fiender varje sekund
setInterval(spawnEnemy, 1000);

// Ã¶ka svÃ¥righet
setInterval(()=>{
  if(gameSpeed < 10) gameSpeed += 0.2;
}, 3000);
</script>

</body>
</html>
