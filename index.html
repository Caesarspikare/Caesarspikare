<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <title>Ryberg Emoji Attack</title>
    <style>
        body { margin: 0; background: #111; color: #0f0; overflow: hidden; font-family: 'Courier New', monospace; }
        canvas { display: block; }
        #hud { position: absolute; top: 10px; left: 10px; pointer-events: none; font-size: 20px; }
        #menu {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.9); padding: 40px; border: 3px solid #0f0; text-align: center;
        }
        button { background: #0f0; color: #000; border: none; padding: 15px 30px; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>

    <div id="hud">SCORE: <span id="s">0</span> | LIV: <span id="l">3</span></div>
    
    <div id="menu">
        <h1>EMOJI INVASION</h1>
        <p>Styr: WASD | Skjut: MUSKLICK</p>
        <button id="go">STARTA SPELET</button>
    </div>

    <canvas id="c"></canvas>

    <script>
        const canvas = document.getElementById('c');
        const ctx = canvas.getContext('2d');
        const menu = document.getElementById('menu');
        
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        let score = 0, lives = 3, active = false;
        let p = { x: canvas.width/2, y: canvas.height-100, w: 40, h: 40 };
        let bullets = [], enemies = [], keys = {};

        window.onkeydown = e => keys[e.code] = true;
        window.onkeyup = e => keys[e.code] = false;
        
        window.onmousedown = () => { 
            if(active) bullets.push({x: p.x + 18, y: p.y, w: 4, h: 12}); 
        };

        document.getElementById('go').onclick = () => {
            menu.style.display = 'none';
            active = true;
            loop();
        };

        function update() {
            // WASD Movement
            if(keys['KeyW'] && p.y > 0) p.y -= 7;
            if(keys['KeyS'] && p.y < canvas.height - p.h) p.y += 7;
            if(keys['KeyA'] && p.x > 0) p.x -= 7;
            if(keys['KeyD'] && p.x < canvas.width - p.w) p.x += 7;

            // Skott
            bullets.forEach((b, i) => {
                b.y -= 12;
                if(b.y < 0) bullets.splice(i, 1);
            });

            // Fiender (Vi ritar emojis istÃ¤llet fÃ¶r bild)
            if(Math.random() < 0.04) {
                enemies.push({ 
                    x: Math.random()*(canvas.width-50), 
                    y: -50, 
                    size: 50, 
                    speed: 3 + (score/300) 
                });
            }

            enemies.forEach((e, i) => {
                e.y += e.speed;
                
                // Kollision Spelare
                if(e.x < p.x + p.w && e.x + e.size > p.x && e.y < p.y + p.h && e.y + e.size > p.y) {
                    enemies.splice(i, 1);
                    lives--;
                    document.getElementById('l').innerText = lives;
                    if(lives <= 0) location.reload();
                }

                // Kollision Skott
                bullets.forEach((b, bi) => {
                    if(b.x < e.x + e.size && b.x + b.w > e.x && b.y < e.y + e.size && b.y + b.h > e.y) {
                        enemies.splice(i, 1);
                        bullets.splice(bi, 1);
                        score += 10;
                        document.getElementById('s').innerText = score;
                    }
                });

                if(e.y > canvas.height) enemies.splice(i, 1);
            });
        }

        function draw() {
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Spelare (Neon-box)
            ctx.fillStyle = '#0f0';
            ctx.shadowBlur = 15;
            ctx.shadowColor = '#0f0';
            ctx.fillRect(p.x, p.y, p.w, p.h);
            ctx.shadowBlur = 0;

            // Skott
            ctx.fillStyle = '#ff0';
            bullets.forEach(b => ctx.fillRect(b.x, b.y, b.w, b.h));

            // Fiender (Emojis)
            ctx.font = "40px Arial";
            enemies.forEach(e => {
                ctx.fillText("ðŸ¤®", e.x, e.y + 40);
            });
        }

        function loop() {
            if(!active) return;
            update();
            draw();
            requestAnimationFrame(loop);
        }
    </script>
</body>
</html>
